from skimage import color
from skimage.color import deltaE_ciede2000, rgb2lab
import numpy as np

class LegoColor:
    def __init__(self, id, name, hex_color_code):
        self.id = id
        self.name = name
        self.hex_color_code = hex_color_code

    def hex(self):
        return self.hex_color_code

    def rgb(self):
        hex_color = self.hex_color_code.lstrip('#')
        return [int(hex_color[i:i+2], 16) for i in (0, 2, 4)] # [255, 255, 255]

    def lab(self):
        return self.__rgb_array_to_lab(self.rgb())

    def distance(self, other):
        other_lab = other.lab() if isinstance(other, LegoColor) else self.__rgb_array_to_lab(other)
        return deltaE_ciede2000(self.lab(), other_lab)[0][0]

    def __repr__(self):
        return f"LegoColor(id={self.id}, name='{self.name}', hex_color_code='{self.hex_color_code}')"

    def __rgb_array_to_lab(self, rgb_array):
        return rgb2lab(np.uint8(np.asarray([[rgb_array]])))


# Generated from rebrickable's colors table in sqlite:
# select 'LegoColor(' || id || ', "' || name || '", "' || rgb ||'"),' from colors;
#
lego_colors = [
    LegoColor(0, "Black", "05131D"),
    LegoColor(1, "Blue", "0055BF"),
    LegoColor(2, "Green", "237841"),
    LegoColor(3, "Dark Turquoise", "008F9B"),
    LegoColor(4, "Red", "C91A09"),
    LegoColor(5, "Dark Pink", "C870A0"),
    LegoColor(6, "Brown", "583927"),
    LegoColor(7, "Light Gray", "9BA19D"),
    LegoColor(8, "Dark Gray", "6D6E5C"),
    LegoColor(9, "Light Blue", "B4D2E3"),
    LegoColor(10, "Bright Green", "4B9F4A"),
    LegoColor(11, "Light Turquoise", "55A5AF"),
    LegoColor(12, "Salmon", "F2705E"),
    LegoColor(13, "Pink", "FC97AC"),
    LegoColor(14, "Yellow", "F2CD37"),
    LegoColor(15, "White", "FFFFFF"),
    LegoColor(17, "Light Green", "C2DAB8"),
    LegoColor(18, "Light Yellow", "FBE696"),
    LegoColor(19, "Tan", "E4CD9E"),
    LegoColor(20, "Light Violet", "C9CAE2"),
    LegoColor(21, "Glow In Dark Opaque", "D4D5C9"),
    LegoColor(22, "Purple", "81007B"),
    LegoColor(23, "Dark Blue-Violet", "2032B0"),
    LegoColor(25, "Orange", "FE8A18"),
    LegoColor(26, "Magenta", "923978"),
    LegoColor(27, "Lime", "BBE90B"),
    LegoColor(28, "Dark Tan", "958A73"),
    LegoColor(29, "Bright Pink", "E4ADC8"),
    LegoColor(30, "Medium Lavender", "AC78BA"),
    LegoColor(31, "Lavender", "E1D5ED"),
    LegoColor(32, "Trans-Black IR Lens", "635F52"),
    LegoColor(33, "Trans-Dark Blue", "0020A0"),
    LegoColor(34, "Trans-Green", "84B68D"),
    LegoColor(35, "Trans-Bright Green", "D9E4A7"),
    LegoColor(36, "Trans-Red", "C91A09"),
    LegoColor(40, "Trans-Black", "635F52"),
    LegoColor(41, "Trans-Light Blue", "AEEFEC"),
    LegoColor(42, "Trans-Neon Green", "F8F184"),
    LegoColor(43, "Trans-Very Lt Blue", "C1DFF0"),
    LegoColor(45, "Trans-Dark Pink", "DF6695"),
    LegoColor(46, "Trans-Yellow", "F5CD2F"),
    LegoColor(47, "Trans-Clear", "FCFCFC"),
    LegoColor(52, "Trans-Purple", "A5A5CB"),
    LegoColor(54, "Trans-Neon Yellow", "DAB000"),
    LegoColor(57, "Trans-Neon Orange", "FF800D"),
    LegoColor(60, "Chrome Antique Brass", "645A4C"),
    LegoColor(61, "Chrome Blue", "6C96BF"),
    LegoColor(62, "Chrome Green", "3CB371"),
    LegoColor(63, "Chrome Pink", "AA4D8E"),
    LegoColor(64, "Chrome Black", "1B2A34"),
    LegoColor(68, "Very Light Orange", "F3CF9B"),
    LegoColor(69, "Light Purple", "CD6298"),
    LegoColor(70, "Reddish Brown", "582A12"),
    LegoColor(71, "Light Bluish Gray", "A0A5A9"),
    LegoColor(72, "Dark Bluish Gray", "6C6E68"),
    LegoColor(73, "Medium Blue", "5A93DB"),
    LegoColor(74, "Medium Green", "73DCA1"),
    LegoColor(75, "Speckle Black-Copper", "05131D"),
    LegoColor(76, "Speckle DBGray-Silver", "6C6E68"),
    LegoColor(77, "Light Pink", "FECCCF"),
    LegoColor(78, "Light Nougat", "F6D7B3"),
    LegoColor(79, "Milky White", "FFFFFF"),
    LegoColor(80, "Metallic Silver", "A5A9B4"),
    LegoColor(81, "Metallic Green", "899B5F"),
    LegoColor(82, "Metallic Gold", "DBAC34"),
    LegoColor(84, "Medium Nougat", "AA7D55"),
    LegoColor(85, "Dark Purple", "3F3691"),
    LegoColor(86, "Light Brown", "7C503A"),
    LegoColor(89, "Royal Blue", "4C61DB"),
    LegoColor(92, "Nougat", "D09168"),
    LegoColor(100, "Light Salmon", "FEBABD"),
    LegoColor(110, "Violet", "4354A3"),
    LegoColor(112, "Medium Bluish Violet", "6874CA"),
    LegoColor(114, "Glitter Trans-Dark Pink", "DF6695"),
    LegoColor(115, "Medium Lime", "C7D23C"),
    LegoColor(117, "Glitter Trans-Clear", "FFFFFF"),
    LegoColor(118, "Aqua", "B3D7D1"),
    LegoColor(120, "Light Lime", "D9E4A7"),
    LegoColor(125, "Light Orange", "F9BA61"),
    LegoColor(129, "Glitter Trans-Purple", "A5A5CB"),
    LegoColor(132, "Speckle Black-Silver", "05131D"),
    LegoColor(133, "Speckle Black-Gold", "05131D"),
    LegoColor(134, "Copper", "AE7A59"),
    LegoColor(135, "Pearl Light Gray", "9CA3A8"),
    LegoColor(137, "Metal Blue", "7988A1"),
    LegoColor(142, "Pearl Light Gold", "DCBC81"),
    LegoColor(143, "Trans-Medium Blue", "CFE2F7"),
    LegoColor(148, "Pearl Dark Gray", "575857"),
    LegoColor(150, "Pearl Very Light Gray", "ABADAC"),
    LegoColor(151, "Very Light Bluish Gray", "E6E3E0"),
    LegoColor(158, "Yellowish Green", "DFEEA5"),
    LegoColor(178, "Flat Dark Gold", "B48455"),
    LegoColor(179, "Flat Silver", "898788"),
    LegoColor(182, "Trans-Orange", "F08F1C"),
    LegoColor(183, "Pearl White", "F2F3F2"),
    LegoColor(191, "Bright Light Orange", "F8BB3D"),
    LegoColor(212, "Bright Light Blue", "9FC3E9"),
    LegoColor(216, "Rust", "B31004"),
    LegoColor(226, "Bright Light Yellow", "FFF03A"),
    LegoColor(230, "Trans-Pink", "E4ADC8"),
    LegoColor(232, "Sky Blue", "7DBFDD"),
    LegoColor(236, "Trans-Light Purple", "96709F"),
    LegoColor(272, "Dark Blue", "0A3463"),
    LegoColor(288, "Dark Green", "184632"),
    LegoColor(294, "Glow In Dark Trans", "BDC6AD"),
    LegoColor(297, "Pearl Gold", "AA7F2E"),
    LegoColor(308, "Dark Brown", "352100"),
    LegoColor(313, "Maersk Blue", "3592C3"),
    LegoColor(320, "Dark Red", "720E0F"),
    LegoColor(321, "Dark Azure", "078BC9"),
    LegoColor(322, "Medium Azure", "36AEBF"),
    LegoColor(323, "Light Aqua", "ADC3C0"),
    LegoColor(326, "Olive Green", "9B9A5A"),
    LegoColor(334, "Chrome Gold", "BBA53D"),
    LegoColor(335, "Sand Red", "D67572"),
    LegoColor(351, "Medium Dark Pink", "F785B1"),
    LegoColor(366, "Earth Orange", "FA9C1C"),
    LegoColor(373, "Sand Purple", "845E84"),
    LegoColor(378, "Sand Green", "A0BCAC"),
    LegoColor(379, "Sand Blue", "6074A1"),
    LegoColor(383, "Chrome Silver", "E0E0E0"),
    LegoColor(450, "Fabuland Brown", "B67B50"),
    LegoColor(462, "Medium Orange", "FFA70B"),
    LegoColor(484, "Dark Orange", "A95500"),
    LegoColor(503, "Very Light Gray", "E6E3DA"),
    LegoColor(1000, "Glow in Dark White", "D9D9D9"),
    LegoColor(1001, "Medium Violet", "9391E4"),
    LegoColor(1002, "Glitter Trans-Neon Green", "C0F500"),
    LegoColor(1003, "Glitter Trans-Light Blue", "68BCC5"),
    LegoColor(1004, "Trans-Flame Yellowish Orange", "FCB76D"),
    LegoColor(1005, "Trans-Fire Yellow", "FBE890"),
    LegoColor(1006, "Trans-Light Royal Blue", "B4D4F7"),
    LegoColor(1007, "Reddish Lilac", "8E5597"),
    LegoColor(1008, "Vintage Blue", "039CBD"),
    LegoColor(1009, "Vintage Green", "1E601E"),
    LegoColor(1010, "Vintage Red", "CA1F08"),
    LegoColor(1011, "Vintage Yellow", "F3C305"),
    LegoColor(1012, "Fabuland Orange", "EF9121"),
    LegoColor(1013, "Modulex White", "F4F4F4"),
    LegoColor(1014, "Modulex Light Bluish Gray", "AfB5C7"),
    LegoColor(1015, "Modulex Light Gray", "9C9C9C"),
    LegoColor(1016, "Modulex Charcoal Gray", "595D60"),
    LegoColor(1017, "Modulex Tile Gray", "6B5A5A"),
    LegoColor(1018, "Modulex Black", "4D4C52"),
    LegoColor(1019, "Modulex Tile Brown", "330000"),
    LegoColor(1020, "Modulex Terracotta", "5C5030"),
    LegoColor(1021, "Modulex Brown", "907450"),
    LegoColor(1022, "Modulex Buff", "DEC69C"),
    LegoColor(1023, "Modulex Red", "B52C20"),
    LegoColor(1024, "Modulex Pink Red", "F45C40"),
    LegoColor(1025, "Modulex Orange", "F47B30"),
    LegoColor(1026, "Modulex Light Orange", "F7AD63"),
    LegoColor(1027, "Modulex Light Yellow", "FFE371"),
    LegoColor(1028, "Modulex Ochre Yellow", "FED557"),
    LegoColor(1029, "Modulex Lemon", "BDC618"),
    LegoColor(1030, "Modulex Pastel Green", "7DB538"),
    LegoColor(1031, "Modulex Olive Green", "7C9051"),
    LegoColor(1032, "Modulex Aqua Green", "27867E"),
    LegoColor(1033, "Modulex Teal Blue", "467083"),
    LegoColor(1034, "Modulex Tile Blue", "0057A6"),
    LegoColor(1035, "Modulex Medium Blue", "61AFFF"),
    LegoColor(1036, "Modulex Pastel Blue", "68AECE"),
    LegoColor(1037, "Modulex Violet", "BD7D85"),
    LegoColor(1038, "Modulex Pink", "F785B1"),
    LegoColor(1039, "Modulex Clear", "FFFFFF"),
    LegoColor(1040, "Modulex Foil Dark Gray", "595D60"),
    LegoColor(1041, "Modulex Foil Light Gray", "9C9C9C"),
    LegoColor(1042, "Modulex Foil Dark Green", "006400"),
    LegoColor(1043, "Modulex Foil Light Green", "7DB538"),
    LegoColor(1044, "Modulex Foil Dark Blue", "0057A6"),
    LegoColor(1045, "Modulex Foil Light Blue", "68AECE"),
    LegoColor(1046, "Modulex Foil Violet", "4B0082"),
    LegoColor(1047, "Modulex Foil Red", "8B0000"),
    LegoColor(1048, "Modulex Foil Yellow", "FED557"),
    LegoColor(1049, "Modulex Foil Orange", "F7AD63"),
    LegoColor(1050, "Coral", "FF698F"),
    LegoColor(1051, "Pastel Blue", "5AC4DA"),
    LegoColor(1052, "Glitter Trans-Orange", "F08F1C"),
    LegoColor(1053, "Trans-Blue Opal", "68BCC5"),
    LegoColor(1054, "Trans-Medium Reddish Violet Opal", "CE1D9B"),
    LegoColor(1055, "Trans-Clear Opal", "FCFCFC"),
    LegoColor(1056, "Trans-Brown Opal", "583927"),
    LegoColor(1057, "Trans-Light Bright Green", "C9E788"),
    LegoColor(1058, "Trans-Light Green", "94E5AB"),
    LegoColor(1059, "Trans-Purple Opal", "8320B7"),
    LegoColor(1060, "Trans-Green Opal", "84B68D"),
    LegoColor(1061, "Trans-Dark Blue Opal", "0020A0"),
    LegoColor(1062, "Vibrant Yellow", "EBD800"),
    LegoColor(1063, "Metallic Copper", "B46A00"),
    LegoColor(1064, "Fabuland Red", "FF8014"),
    LegoColor(1065, "Reddish Gold", "AC8247"),
    LegoColor(1066, "Curry", "DD982E"),
    LegoColor(1067, "Dark Nougat", "AD6140"),
    LegoColor(1068, "Reddish Orange", "EE5434"),
    LegoColor(1069, "Pearl Red", "D60026"),
    LegoColor(1070, "Pearl Blue", "0059A3"),
    LegoColor(1071, "Pearl Green", "008E3C"),
    LegoColor(1072, "Pearl Brown", "57392C"),
    LegoColor(1073, "Pearl Black", "0A1327"),
    LegoColor(1074, "Duplo Blue", "009ECE"),
    LegoColor(1075, "Duplo Medium Blue", "3E95B6"),
    LegoColor(1076, "Duplo Lime", "FFF230"),
    LegoColor(1077, "Fabuland Lime", "78FC78"),
    LegoColor(1078, "Duplo Medium Green", "468A5F"),
    LegoColor(1079, "Duplo Light Green", "60BA76"),
    LegoColor(1080, "Light Tan", "F3C988"),
    LegoColor(1081, "Rust Orange", "872B17"),
    LegoColor(1082, "Clikits Pink", "FE78B0"),
    LegoColor(1083, "Two-tone Copper", "945148"),
    LegoColor(1084, "Two-tone Gold", "AB673A"),
    LegoColor(1085, "Two-tone Silver", "737271"),
    LegoColor(1086, "Pearl Lime", "6A7944"),
    LegoColor(1087, "Duplo Pink", "FF879C"),
    LegoColor(1088, "Medium Brown", "755945"),
    LegoColor(1089, "Warm Tan", "CCA373"),
    LegoColor(1090, "Duplo Turquoise", "3FB69E"),
]


lego_colors_by_id = {lego_color.id: lego_color for lego_color in lego_colors}
